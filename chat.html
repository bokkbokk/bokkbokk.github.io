<!DOCTYPE html>
<html>
<head>
  <title>Realtime Chat</title>
  <style>
    body { font-family: sans-serif; }
    #chat-container { width: 500px; margin: 0 auto; border: 1px solid #ccc; padding: 10px; }
    #message-list { height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; }
    .message { margin-bottom: 10px; }
    .user-message { text-align: right; }
    .other-message { text-align: left; }
    .username { font-weight: bold; }
  </style>
  <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.29.9.min.js"></script>
</head>
<body>
  <div id="chat-container">
    <h1>Realtime Chat</h1>
    <div id="message-list"></div>
    <div>
      <input type="text" id="username" placeholder="Enter your username" />
      <input type="text" id="message" placeholder="Enter message" />
      <button id="send-button">Send</button>
    </div>
  </div>

  <script>
    // Initialize PubNub
    const pubnub = new PubNub({
      publishKey: 'pub-c-9233a71f-55d9-4a79-8c20-49437dac12d4',
      subscribeKey: 'sub-c-d33fc166-7366-400a-a165-dd78a88ed735'
    });

    const messageList = document.getElementById('message-list');
    const usernameInput = document.getElementById('username');
    const messageInput = document.getElementById('message');
    const sendButton = document.getElementById('send-button');
    const channel = 'chat';

    sendButton.addEventListener('click', () => {
      const username = usernameInput.value;
      const message = messageInput.value;

      if (message.trim() !== '' && username.trim() !== '') {
        pubnub.publish({
          channel: channel,
          message: { username: username, message: message }
        });
        messageInput.value = '';
      } else {
        alert('Please enter both a username and a message.');
      }
    });

    pubnub.subscribe({ channels: [channel] });

    pubnub.addListener({
      message: function(event) {
        const data = event.message;
        displayMessage(data.username, data.message);
      }
    });

    function displayMessage(username, message) {
      const messageElement = document.createElement('div');
      messageElement.classList.add('message');
      messageElement.classList.add(username === usernameInput.value ? 'user-message' : 'other-message');
      messageElement.innerHTML = `<span class="username">${username}:</span> ${message}`;
      messageList.appendChild(messageElement);
      messageList.scrollTop = messageList.scrollHeight;
    }
  </script>
</body>
</html>
