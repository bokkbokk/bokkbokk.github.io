<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=open_in_new" />
<title>Latin is Better</title>
<style>
        body {
          font-family: "IM Fell English SC", serif;
          margin: 0;
          padding: 20px;
          background: #f0e6d2;
          color: #2c1810;
          line-height: 1.6;
          background-image: linear-gradient(
              rgba(240, 230, 210, 0.9),
              rgba(240, 230, 210, 0.9)
            ),
            url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10,10 h80 v80 h-80 z' fill='none' stroke='%23d4c5a8' stroke-width='1'/%3E%3C/svg%3E");
        }
  
        .container {
          max-width: 800px;
          margin: 0 auto;
          background: #fff9e6;
          padding: 2rem;
          border-radius: 0;
          box-shadow: 0 2px 15px rgba(44, 24, 16, 0.2);
          border: 2px solid #8b4513;
          position: relative;
        }
  
        h1 {
          color: #8b4513;
          text-align: center;
          margin-bottom: 1.5rem;
          font-size: 2.5rem;
          font-variant: small-caps;
          letter-spacing: 2px;
          text-shadow: 2px 2px 4px rgba(139, 69, 19, 0.2);
        }
  
        .search-container {
          display: flex;
          gap: 10px;
          margin-bottom: 2rem;
          flex-wrap: wrap;
          justify-content: flex-end; /* Add this */
        }
  
        input {
          flex: 1;
          padding: 12px;
          border: 2px solid #8b4513;
          background: #fff9e6;
          border-radius: 0;
          font-size: 1rem;
          min-width: 200px;
          font-family: "Times New Roman", serif;
          transition: border-color 0.3s;
        }
  
        input:focus {
          outline: none;
          border-color: #d2691e;
        }
  
        button {
          padding: 12px 20px;
          background: #8b4513;
          color: #fff9e6;
          border: none;
          cursor: pointer;
          font-size: 1rem;
          font-family: "Times New Roman", serif;
          transition: background 0.3s;
          text-transform: uppercase;
          letter-spacing: 1px;
        }
  
        button:hover {
          background: #d2691e;
        }
  
        .entry {
          background: #fff9e6;
          padding: 1.5rem;
          margin-bottom: 1rem;
          border-left: 4px solid #8b4513;
          box-shadow: 0 2px 5px rgba(44, 24, 16, 0.1);
          transition: transform 0.2s;
          border: 1px solid #d4c5a8;
          position: relative; /* Add this */
          padding-top: 2.5rem; /* Add space for the badge */
        }
  
        .entry:hover {
          transform: translateX(5px);
        }
  
        .entry h3 {
          margin: 0;
          color: #8b4513;
          font-size: 1.6rem;
          font-variant: small-caps;
        }
  
        .entry p {
          margin: 0.5rem 0;
          color: #2c1810;
        }
  
        .url {
          color: #8b4513;
          text-decoration: none;
          font-weight: 500;
          display: inline-block;
          margin-top: 0.5rem;
          transition: color 0.3s;
          border-bottom: 1px solid transparent;
          position: absolute; /* Add this */
          top: 8px; /* Add this */
          right: 8px; /* Add this */
          
        }
  
        .url:hover {
          color: #d2691e;
          border-bottom: 1px solid #d2691e;
        }
        .lis {
          position: absolute; /* Add this */
          top: 8px; /* Add this */
          right: 8px; /* Add this */
        }
  
        .loading {
          text-align: center;
          padding: 2rem;
          color: #8b4513;
          font-style: italic;
        }
  
        .type-badge {
          display: inline-block;
          padding: 3px 8px;
          font-size: 1rem;
          background: #39661a;
          color: #fff9e6;
          font-variant: small-caps;
          position: absolute; /* Add this */
          top: 8px; /* Add this */
          left: 8px; /* Add this */
        }
        .whit-badge {
          display: inline-block;
          padding: 3px 8px;
          font-size: 1rem;
          background: #39661a;
          color: #fff9e6;
          font-variant: small-caps;
          position: absolute; /* Add this */
          bottom: 8px; /* Add this */
          right: 8px; /* Add this */
        }
      /* .fetched-data {

          empty for now
        }
      */
        .converter-modal {
          display: none;
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: #fff9e6;
          padding: 2rem;
          border: 2px solid #8b4513;
          box-shadow: 0 4px 20px rgba(44, 24, 16, 0.3);
          z-index: 1000;
          max-width: 90%;
          width: 400px;
        }
  
        .modal-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(44, 24, 16, 0.5);
          z-index: 999;
        }
  
        .close-modal {
          position: absolute;
          top: 10px;
          right: 10px;
          cursor: pointer;
          font-size: 1.5rem;
          color: #8b4513;
        }
  
        .converter-input {
          width: 100%;
          margin-bottom: 1rem;
        }
  
        .converter-result {
          font-size: 1.2rem;
          text-align: center;
          margin-top: 1rem;
          font-weight: bold;
          color: #8b4513;
        }
  
        .numbtn {
          position: fixed;
          right: 30px;
          top: 50%;
          transform: translateY(-50%);
          width: 70px;
          height: 70px;
          border-radius: 1%; 
          background: #fff9e6;
          color: #8b4513;
          border: solid, #8b4513;
          cursor: pointer;
          box-shadow: 0 4px 15px rgba(44, 24, 16, 0.3);
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.8rem;
          text-align: center;
          padding: 10px;
          line-height: 1.2;
        }
  
        .numbtn:hover {
          background: #d2691e;
          color: #fff9e6 ;
          transform: translateY(-50%) scale(1.1);
        }
        
</style>
<script>
        let removeSecondForm = false;
        let isLoading = false;
  
        function showLoading() {
          const outputDiv = document.getElementById("outputIndex");
          outputDiv.innerHTML = '<div class="loading">Loading results...</div>';
        }
  
        function fetchIndexData() {
          if (isLoading) return;
  
          const searchTerm = document.getElementById("searchTerm").value;
          if (!searchTerm.trim()) {
            alert("Please enter a search term");
            return;
          }
  
          isLoading = true;
          showLoading();
  
          fetch(
            `https://latin-proxy.vercel.app/api/index?term=${encodeURIComponent(
              searchTerm
            )}`
          )
            .then((response) => {
              if (!response.ok) {
                throw new Error("network error :(");
              }
              return response.json();
            })
            .then((data) => {
              const outputDiv = document.getElementById("outputIndex");
              outputDiv.innerHTML = "";
  
              if (data.length === 0) {
                outputDiv.innerHTML =
                  '<div class="entry"><p>No results found</p></div>';
                return;
              }
  
              data.forEach((entry) => {
                let fullName = entry.full_name;
                if (entry.intern_type === "verb" && removeSecondForm) {
                  const forms = fullName.split(", ");
                  if (forms.length > 1) {
                    forms.splice(1, 1);
                    fullName = forms.join(", ");
                  }
                }
  
                const entryDiv = document.createElement("div");
                entryDiv.className = "entry";
                let cbadge = "8b4513";
                if (entry.intern_type === "verb") {
                  cbadge = "2522BB";
                } else if (entry.intern_type === "adjective") {
                  cbadge = "CE2424";
                } else if (entry.intern_type === "adverb") {
                  cbadge = "7A2370";
                } else if (entry.intern_type === "noun") {
                  cbadge = "39661A";
                } else if (entry.intern_type === "phrase") {
                  cbadge = "F39C12";
                }
  
                entryDiv.innerHTML = `
                    <span class="type-badge" style="background:#${cbadge}">${entry.intern_type}</span>

                    <h3>${fullName}</h3>

                    <p><strong>Translations:</strong> ${entry.translations_unstructured.en}</p>

                    <p><strong>Type:</strong> ${entry.type.label}</p>
                    
                    <a class="url"class="lis" href="${entry.url}" target="_blank">             
                    <span class="material-symbols-outlined" class="lis"> open_in_new </span>
                    </a>

                    <button class="whit-badge"onclick="fetchData('${entry.short_name}', this)"> Check Whitakers Words </button>
                    
                    <div class="fetched-data"></div>
                `;
                outputDiv.appendChild(entryDiv);
              });
            })
            .catch((error) => {
              console.error("Error fetching data:", error);
              document.getElementById("outputIndex").innerHTML =
                '<div class="entry"><p>No such luck, Please try again.</p></div>';
            })
            .finally(() => {
              isLoading = false;
            });
        }
        
      function fetchData(shortName, button) {
        const parentDiv = button.closest("div"); //appropriate container
        const fetchedDataDiv = parentDiv.querySelector(".fetched-data");
        
        fetchedDataDiv.style.border = "solid";
        fetchedDataDiv.style.padding = "2px";
        fetchedDataDiv.textContent = "Loading..."; 
        //loaddingggggg........

        fetch(`https://latin-proxy.vercel.app/api/whit?term=${shortName}`)
            .then(response => response.text())
            .then(data => {
               // convert into HTML
                fetchedDataDiv.innerHTML = data;
            })
        .catch(error => {
            fetchedDataDiv.textContent = "Error loading data.";
            console.error("Error:", error);
        });
}
  
        function toggleSecondForm() {
          removeSecondForm = !removeSecondForm;
          const toggleButton = document.getElementById("toggleButton");
          toggleButton.textContent = removeSecondForm
            ? "Show All Forms"
            : "Remove Second Form";
  
          const searchTerm = document.getElementById("searchTerm").value;
          if (searchTerm.trim()) {
            fetchIndexData();
          }
        }
  
        function openConverter() {
          document.getElementById('converterModal').style.display = 'block';
          document.getElementById('modalOverlay').style.display = 'block';
        }
  
        function closeConverter() {
          document.getElementById('converterModal').style.display = 'none';
          document.getElementById('modalOverlay').style.display = 'none';
        }
  
        function convertNumber() {
          const input = document.getElementById('numberInput').value;
          const number = parseInt(input);
          
          if (isNaN(number) || number < 1 || number > 3999) {
            document.getElementById('convertResult').textContent = 'Please enter a number between 1 and 3999';
            return;
          }
          
          const romanNumerals = [
            { value: 1000, symbol: 'M' },
            { value: 900, symbol: 'CM' },
            { value: 500, symbol: 'D' },
            { value: 400, symbol: 'CD' },
            { value: 100, symbol: 'C' },
            { value: 90, symbol: 'XC' },
            { value: 50, symbol: 'L' },
            { value: 40, symbol: 'XL' },
            { value: 10, symbol: 'X' },
            { value: 9, symbol: 'IX' },
            { value: 5, symbol: 'V' },
            { value: 4, symbol: 'IV' },
            { value: 1, symbol: 'I' }
          ];
          
          let result = '';
          let remaining = number;
          
          for (let numeral of romanNumerals) {
            while (remaining >= numeral.value) {
              result += numeral.symbol;
              remaining -= numeral.value;
            }
          }
          
          document.getElementById('convertResult').textContent = result;
        }
  
        // Add event listener for Enter key in converter
        document.addEventListener('DOMContentLoaded', () => {
          document
            .getElementById("searchTerm")
            .addEventListener("keypress", (e) => {
              if (e.key === "Enter") {
                fetchIndexData();
              }
            });
          document.getElementById('numberInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              convertNumber();
            }
          });
        });
</script>
</head>
<body>
<div class="container">
    <h1>Latin is Better</h1>
    <div class="search-container">
      <input type="text" id="searchTerm" placeholder="search.." />
      <button onclick="fetchIndexData()">Search</button>
      <button id="toggleButton" onclick="toggleSecondForm()">Remove Second Form</button>
    </div>
    <div id="outputIndex"></div>
</div>

<button style="padding:5%"class="numbtn" onclick="openConverter()">Roman Numerals</button>

<div id="modalOverlay" class="modal-overlay" onclick="closeConverter()"></div>
<div id="converterModal" class="converter-modal">
    <span class="close-modal" onclick="closeConverter()">&times;</span>
    <h2 style="text-align: center; color: #8b4513; margin-bottom: 1.5rem;">Roman Numeral Converter</h2>
    <input type="number" id="numberInput" class="converter-input" placeholder="Enter a number (1-3999)" min="1" max="3999" />
    <button onclick="convertNumber()" style="width: 100%;">Convert</button>
    <div id="convertResult" class="converter-result"></div>
</div>

</body>
</html>
